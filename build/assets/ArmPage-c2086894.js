import{a as l,A as f,r as n,M as r,j as e,C as k,b as u,c as w,d as S,G as c,e as q,__tla as T}from"./index-ed88989a.js";import{G as C}from"./Graph-b962b43a.js";import{S as H,N as h}from"./NumberInput-ab658c02.js";import{S as F,u as N,a}from"./L1ControlledNumber-9a2b012a.js";import{M as m}from"./MeasurementInput-70656c8f.js";import{M as v,R as E}from"./RatioInput-7ba7bad2.js";import{M as G}from"./MeasurementOutput-fca1a435.js";import{u as R,K as _}from"./KgKvKaDisplay-94b48dc7.js";import{w as I}from"./promise-worker-e6956b4a.js";import{c as P,a as V,b as K}from"./sharedMath-4842c3fc.js";import{A as z}from"./readmes-1eff17f1.js";import"./io-df8bba7d.js";let g,B=Promise.all([(()=>{try{return T}catch{}})()]).then(async()=>{function x(){return new Worker("/assets/armMath-a2bc5386.js")}class j{static getState(){if(l.version===void 0)throw Error("Config did not set version! "+l.url);return F.BumpState(l.version,[f],[])}}const p=await I(new x);function b(){const[t,i]=N(j.getState()),[y,d]=n.useState(!0),s=R([],async()=>{d(!0);const o=await p.calculateArmStates(t.motor.toDict(),t.ratio.toDict(),t.comLength.toDict(),t.armMass.toDict(),t.currentLimit.toDict(),t.startAngle.toDict(),t.endAngle.toDict(),t.iterationLimit);return d(!1),o},[t.motor,t.ratio,t.comLength,t.armMass,t.currentLimit,t.startAngle,t.endAngle,t.iterationLimit]),M=n.useMemo(()=>s.length>0?r.fromDict(s[s.length-1].time):new r(0,"s"),[s]),L=n.useMemo(()=>P(t.motor.stallTorque.mul(t.motor.quantity).mul(t.ratio.asNumber()),t.comLength,t.armMass.mul(t.efficiency/100)),[t.motor.stallTorque,t.motor.quantity,t.ratio,t.comLength,t.armMass,t.efficiency]),A=n.useMemo(()=>t.ratio.asNumber()==0?new r(0,"V*s/rad"):V(t.motor.freeSpeed.div(t.ratio.asNumber()),new r(1,"rad")),[t.motor.freeSpeed,t.ratio]),D=n.useMemo(()=>K(t.motor.stallTorque.mul(t.motor.quantity).mul(t.ratio.asNumber()).mul(t.efficiency/100),t.comLength.mul(t.comLength).div(new r(1,"rad")),t.armMass),[t.motor.stallTorque,t.motor.quantity,t.ratio,t.efficiency,t.comLength,t.armMass]);return e.jsxs(e.Fragment,{children:[e.jsx(H,{queryParams:f,state:t,title:"Arm Calculator"}),e.jsxs(k,{children:[e.jsxs(u,{children:[e.jsx(a,{label:"Motor",id:"motor",tooltip:"Motors powering the arm.",children:e.jsx(v,{stateHook:[t.motor,i.setMotor]})}),e.jsx(a,{label:"Ratio",id:"ratio",tooltip:"Ratio of the gearbox.",children:e.jsx(E,{stateHook:[t.ratio,i.setRatio]})}),e.jsx(a,{label:"Efficiency (%)",id:"efficiency",tooltip:"The efficiency of the system in transmitting torque from the motors.",children:e.jsx(h,{stateHook:[t.efficiency,i.setEfficiency]})}),e.jsx(a,{label:"Current Limit",id:"currentLimit",tooltip:"Current limit applied to each motor.",children:e.jsx(m,{stateHook:[t.currentLimit,i.setCurrentLimit]})}),e.jsx(a,{label:"CoM Distance",id:"comLength",tooltip:e.jsxs(e.Fragment,{children:["Distance of the center of mass",e.jsx("br",{}),"from the rotation point."]}),children:e.jsx(m,{stateHook:[t.comLength,i.setComLength]})}),e.jsx(a,{label:"Arm Mass",id:"armMass",tooltip:e.jsxs(e.Fragment,{children:["Mass of the arm measured",e.jsx("br",{})," at the center of mass."]}),children:e.jsx(m,{stateHook:[t.armMass,i.setArmMass]})}),e.jsx(a,{label:"Start Angle",id:"startAngle",tooltip:e.jsxs(e.Fragment,{children:["Starting angle of the arm.",e.jsx("br",{}),"Must be less than end angle."]}),children:e.jsx(m,{stateHook:[t.startAngle,i.setStartAngle]})}),e.jsx(a,{label:"End Angle",id:"endAngle",tooltip:e.jsxs(e.Fragment,{children:["Ending angle of the arm.",e.jsx("br",{}),"Must be greater than start angle."]}),children:e.jsx(m,{stateHook:[t.endAngle,i.setEndAngle]})}),e.jsx(a,{label:"Iteration Limit",id:"iterationLimit",tooltip:"Number of time-cycles to simulate.",children:e.jsx(h,{stateHook:[t.iterationLimit,i.setIterationLimit]})}),e.jsx(a,{label:"Time To Goal",id:"timeToGoal",tooltip:"Time from start angle to end angle.",children:e.jsx(G,{stateHook:[M,()=>{}],numberRoundTo:3,loadingIf:()=>y})}),e.jsxs(w,{color:"warning",children:["The time to goal currently ",e.jsx("b",{children:"does not"})," account for deceleration of the arm when approaching the target. It ",e.jsx("b",{children:"does"})," account for the initial acceleration from zero. ",e.jsx("br",{}),e.jsx("br",{}),"For more clarifying info, click the ",e.jsx("code",{children:"Docs"})," expandable below."]}),e.jsx(_,{kG:L,kV:A,kA:D,distanceType:"angular"})]}),e.jsx(u,{children:e.jsx(C,{options:S,simpleDatasets:[c.dataset("Position (deg)",s.map(o=>({x:r.fromDict(o.time).scalar,y:r.fromDict(o.position).to("deg").scalar})),0,"y-position"),c.dataset("Current (A)",s.map(o=>({x:r.fromDict(o.time).scalar,y:r.fromDict(o.motorState.current).to("A").scalar})),1,"y-current"),c.dataset("Motor RPM",s.map(o=>({x:r.fromDict(o.time).scalar,y:r.fromDict(o.motorState.rpm).to("rpm").scalar})),2,"y-rpm"),c.dataset("Motor Torque",s.map(o=>({x:r.fromDict(o.time).scalar,y:r.fromDict(o.motorState.torque).to("N m").scalar})),3,"y-torque")],title:"",id:"armGraph",height:800})})]})]})}g=function(){return e.jsxs(e.Fragment,{children:[e.jsx(q,{pageConfig:l}),e.jsx(b,{}),e.jsx(z,{})]})}});export{B as __tla,g as default};
